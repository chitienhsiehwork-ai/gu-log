---
ticketId: "Lv-04"
title: "OpenClaw Gateway æ ¸å¿ƒï¼šä½ çš„ AI ç®¡å®¶é•·ä»€éº¼æ¨£"
originalDate: "2026-02-18"
source: "Level-Up ç³»åˆ—"
sourceUrl: "https://gu-log.vercel.app/posts/levelup-20260218-04-openclaw-gateway-core"
summary: "å¾é›¶é–‹å§‹ç†è§£ OpenClaw æ¶æ§‹ã€‚ç”¨ Python äººçš„è¦–è§’ï¼Œæ‹†è§£ Gatewayã€WebSocket RPCã€Session ç®¡ç†ã€Auth ç­‰æ ¸å¿ƒæ¦‚å¿µã€‚æ¯å±¤æ¨“éƒ½æœ‰ Quizï¼"
lang: "zh-tw"
tags: ["openclaw", "architecture", "gateway", "websocket", "tutorial", "level-up"]
---

import LevelUpProgress from '../../components/LevelUpProgress.astro';
import LevelUpQuiz from '../../components/LevelUpQuiz.astro';
import ClawdNote from '../../components/ClawdNote.astro';
import AnalogyBox from '../../components/AnalogyBox.astro';

æ­¡è¿ä¾†åˆ° Level-Up ç³»åˆ—ç¬¬å››ç¯‡ã€‚

ä»Šå¤©æˆ‘å€‘è¦å¾é›¶é–‹å§‹ææ‡‚ **OpenClaw** â€”â€” ä¸€å€‹è·‘åœ¨ä½ è‡ªå·±æ©Ÿå™¨ä¸Šçš„ AI ç®¡å®¶ç³»çµ±ã€‚å¦‚æœä½ æ˜¯ Python å¾Œç«¯å‡ºèº«ã€å° TypeScript / Node.js ä¸€ç«…ä¸é€šï¼Œæ­å–œä½ ä¾†å°åœ°æ–¹äº†ï¼Œæ•´ç¯‡æ–‡ç« æœƒç”¨ Python ä¸–ç•Œçš„èªè¨€å¸¶ä½ èµ°ä¸€éã€‚

10 å±¤æ¨“ + Boss Floorï¼Œæº–å‚™å¥½å°±å‡ºç™¼ ğŸ—¡ï¸

---

## ğŸ° Floor 0ï¼šOpenClaw æ˜¯ä»€éº¼ï¼Ÿï¼ˆé³¥ç°ï¼‰

<LevelUpProgress current={0} total={10} title="OpenClaw Gateway æ ¸å¿ƒ" />

ä¸€å¥è©±ï¼š

> **OpenClaw æ˜¯ä¸€å€‹è·‘åœ¨ä½ è‡ªå·±æ©Ÿå™¨ä¸Šçš„ AI åŠ©æ‰‹ï¼Œé€éä½ å·²ç¶“åœ¨ç”¨çš„é€šè¨Šè»Ÿé«”è·Ÿä½ å°è©±ã€‚**

å®ƒä¸æ˜¯ ChatGPTï¼ˆé‚£æ˜¯åˆ¥äººçš„ web UIï¼‰ï¼Œä¸æ˜¯ API wrapperï¼Œæ˜¯ä¸€å€‹å®Œæ•´çš„**æ§åˆ¶å¹³é¢ï¼ˆcontrol planeï¼‰**â€”â€” æœ‰ session ç®¡ç†ã€authã€failoverã€æ’ç¨‹ã€tool åŸ·è¡Œï¼Œä»€éº¼éƒ½æœ‰ã€‚

<AnalogyBox title="ğŸ  ç®¡å®¶çš„æ¯”å–»">

æƒ³åƒä½ å®¶é›‡äº†ä¸€å€‹ç®¡å®¶ï¼š

- ä½åœ¨ä½ å®¶ server ä¸Šï¼ˆä¸æ˜¯ä½åœ¨åˆ¥äººå®¶ï¼‰
- æœƒæ¥ **Telegram çš„é›»è©±**ã€**Discord çš„è¨Šæ¯**ã€**WhatsApp çš„ç•™è¨€**
- ä¸åªæœƒèŠå¤© â€”â€” é‚„èƒ½è·‘ç¨‹å¼ã€æŸ¥è³‡æ–™ã€æ“ä½œé›»è…¦ã€è¨­å®šé¬§é˜
- è…¦è¢‹å¯ä»¥æ› â€”â€” ä»Šå¤©ç”¨ Claudeï¼Œæ˜å¤©æ› GPT-4o

</AnalogyBox>

**æ¶æ§‹ä¸€è¦½**

```
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  Telegram â”€â”€â”€â”€â”€â”€> â”‚              â”‚ â”€â”€â”€â”€â”€â”€> Agent (Claude / GPT)
  Discord  â”€â”€â”€â”€â”€â”€> â”‚   Gateway    â”‚ â”€â”€â”€â”€â”€â”€> Tools (shell, browser, files...)
  WhatsApp â”€â”€â”€â”€â”€â”€> â”‚  ï¼ˆå¤§è…¦ï¼‰     â”‚ â”€â”€â”€â”€â”€â”€> Cron (æ’ç¨‹ä»»å‹™)
                   â”‚              â”‚ â”€â”€â”€â”€â”€â”€> Nodes (æ‰‹æ©Ÿã€å…¶ä»–è£ç½®)
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **Gateway** = å¤§è…¦ï¼Œæ‰€æœ‰æ±è¥¿çš„ä¸­å¿ƒ
- **Channels** = è€³æœµå˜´å·´ï¼ˆTelegramã€Discordï¼‰
- **Agent** = æ€è€ƒå¼•æ“ï¼ˆå‘¼å« LLM APIï¼‰
- **Tools** = æ‰‹è…³ï¼ˆshellã€ç€è¦½å™¨ã€æª”æ¡ˆè®€å¯«ï¼‰

åŸºæœ¬æ•¸å­—ï¼š**269 å€‹ dist modules**ã€1,086 å€‹ test filesã€Node.js >= 22ã€MIT licenseã€‚Creator æ˜¯ Peter Steinbergerã€‚

<ClawdNote variant="murmur">
å° Python äººä¾†èªªï¼ŒOpenClaw æœ‰é»åƒä½ ç”¨ FastAPI å¯«äº†ä¸€å€‹è¶…ç´š bot backendï¼Œç„¶å¾ŒæŠŠ LangChain agentã€APSchedulerã€sqlite å…¨éƒ¨å¡é€²åŒä¸€å€‹ processã€‚ä½†äººå®¶å¯«å¾—æ¯”ä½ å¥½ï¼ˆè€Œä¸”çœŸçš„ production-readyï¼‰ã€‚
</ClawdNote>

<LevelUpQuiz
  question="OpenClaw è·Ÿ ChatGPT æœ€å¤§çš„å·®åˆ¥æ˜¯ä»€éº¼ï¼Ÿ"
  options={[
    { label: "A", text: "OpenClaw æ¯”è¼ƒä¾¿å®œ" },
    { label: "B", text: "OpenClaw è·‘åœ¨ä½ è‡ªå·±çš„æ©Ÿå™¨ä¸Šï¼Œé€éç¾æœ‰é€šè¨Šè»Ÿé«”å°è©±" },
    { label: "C", text: "OpenClaw åªæ”¯æ´ Claude" },
    { label: "D", text: "OpenClaw æœ‰ç¶²é ä»‹é¢" },
  ]}
  answer="B"
  explanation="OpenClaw è·‘åœ¨ä½ è‡ªå·±æ©Ÿå™¨ä¸Šï¼Œé€é Telegramã€Discord ç­‰é€šè¨Šè»Ÿé«”å°è©±ã€‚ChatGPT æ˜¯ OpenAI çš„ web UIï¼Œè·‘åœ¨ä»–å€‘çš„ serverã€‚æ ¸å¿ƒå·®åˆ¥æ˜¯ã€Œèª°æ§åˆ¶è‘— AIã€ã€‚"
/>

---

## ğŸ° Floor 1ï¼šç‚ºä»€éº¼ Hub-and-Spokeï¼Ÿä¸ç”¨ Microservicesï¼Ÿ

<LevelUpProgress current={1} total={10} title="OpenClaw Gateway æ ¸å¿ƒ" />

å…ˆææ‡‚é€™å€‹è©ï¼š**Hub-and-Spoke**ï¼ˆè¼ªè»¸èˆ‡è¼»æ¢ï¼‰ã€‚

æƒ³åƒä¸€å€‹è…³è¸è»Šè¼ªå­ï¼šä¸­é–“æœ‰ä¸€å€‹ **hub**ï¼ˆè¼ªè»¸ï¼‰ï¼Œå››å‘¨ä¼¸å‡ºå¾ˆå¤š **spoke**ï¼ˆè¼»æ¢ï¼‰ã€‚æ‰€æœ‰è¼»æ¢éƒ½é€£åˆ°è¼ªè»¸ï¼Œä½†è¼»æ¢ä¹‹é–“**ä¸æœƒç›´æ¥ç¢°åˆ°å½¼æ­¤**ã€‚

åœ¨ OpenClaw è£¡ï¼š
- **Hub** = Gatewayï¼ˆä¸­å¿ƒæ§åˆ¶å°ï¼‰
- **Spokes** = Telegramã€Discordã€Agentã€Toolsâ€¦â€¦ï¼ˆå„ç¨®å…ƒä»¶ï¼‰

æ‰€æœ‰æ±è¥¿éƒ½é€é Gateway æºé€šï¼ŒTelegram ä¸æœƒç›´æ¥è·Ÿ Agent èªªè©±ã€Tools ä¸æœƒç›´æ¥è·Ÿ Discord èŠå¤©ã€‚ä¸€åˆ‡ç¶“é Gateway ä¸­è½‰ã€‚

<ClawdNote variant="murmur">
é †å¸¶ä¸€æï¼ŒGitHub çš„ hub ä¹Ÿæ˜¯é€™å€‹æ„æ€ â€”â€” ã€Œä¸­å¿ƒé›†æ•£åœ°ã€ã€‚ä½† spoke ä¸æ˜¯ speak çš„éå»å¼å–”ï¼Œæ˜¯è…³è¸è»Šçš„è¼»æ¢ ğŸš²
</ClawdNote>

çœ‹åˆ°é€™å€‹æ¶æ§‹ä½ å¯èƒ½æœƒå•ï¼šã€Œé€™éº¼å¤šæ±è¥¿â€¦â€¦ ä¸æ˜¯è©²æ‹†æˆ microservices å—ï¼Ÿã€

ç­”æ¡ˆï¼š**ä¸ç”¨ã€‚**

<AnalogyBox title="ğŸ• Pizza åº— vs ç¾é£Ÿè¡—">

**Pizza åº—ï¼ˆå–® processï¼‰** â€”â€” ä¸€å€‹è€é—†æå®šæ¥å–®ã€åš pizzaã€æ”¶éŠ€ã€å¤–é€ã€‚æºé€šæˆæœ¬é›¶ã€ä¸éœ€è¦å°è¬›æ©Ÿã€‚

**ç¾é£Ÿè¡—ï¼ˆmicroservicesï¼‰** â€”â€” æ¯æ”¤ä¸€å€‹è€é—†ã€‚éœ€è¦æ’éšŠç³»çµ±ï¼ˆmessage queueï¼‰ã€æŒ‡å¼•ç‰Œï¼ˆservice discoveryï¼‰ã€ç®¡å§”æœƒï¼ˆservice meshï¼‰ã€‚

</AnalogyBox>

Peter é¸äº† Pizza åº—ã€‚å› ç‚º OpenClaw æ˜¯ **single-user personal assistant**ï¼š

- åŒæ™‚åœ¨ç”¨çš„äºº = **1 å€‹**ï¼ˆå°±æ˜¯ä½ ï¼‰
- ä¸éœ€è¦æ°´å¹³æ“´å±•ã€ä¸éœ€è¦ load balance
- å–® process çœæ‰ Celery / RabbitMQ / Consul / k8s / distributed tracing

<ClawdNote variant="murmur">
Python çš„é¡æ¯”ï¼šä½ å¯«ä¸€å€‹è‡ªå·±ç”¨çš„ side projectï¼Œä½ æœƒä¸Š k8s + Celery + Redis + RabbitMQ å—ï¼Ÿä¸æœƒå˜›ï¼Œä½ å°±é–‹ä¸€å€‹ FastAPI process è·‘å®Œæ‰€æœ‰æ±è¥¿ã€‚OpenClaw å°±æ˜¯é€™å€‹æ€è·¯ï¼Œåªæ˜¯åšå¾—å¾ˆå°ˆæ¥­ã€‚
</ClawdNote>

ä»£åƒ¹æ˜¯ä¸èƒ½å¤šå° server load balanceã€ä¸€å€‹ crash å…¨éƒ¨æ›ã€‚ä½† single-user å ´æ™¯ï¼Œ**é€™äº›ä»£åƒ¹æ ¹æœ¬ä¸é‡è¦**ã€‚

<LevelUpQuiz
  question="ç‚ºä»€éº¼ OpenClaw é¸æ“‡å–® process è€Œä¸æ˜¯ microservicesï¼Ÿ"
  options={[
    { label: "A", text: "å› ç‚º Node.js ä¸æ”¯æ´ microservices" },
    { label: "B", text: "å› ç‚º microservices æ¯”è¼ƒæ…¢" },
    { label: "C", text: "å› ç‚º single-user ä¸éœ€è¦æ°´å¹³æ“´å±•ï¼Œå–® process çœæ‰å¤§é‡è¤‡é›œåº¦" },
    { label: "D", text: "å› ç‚º Peter ä¸æœƒå¯« microservices" },
  ]}
  answer="C"
  explanation="Single-user personal assistant ä¸éœ€è¦æ°´å¹³æ“´å±•ï¼Œå–® process è¨­è¨ˆçœæ‰ service meshã€message queueã€service discovery ç­‰æ‰€æœ‰åˆ†æ•£å¼ç³»çµ±çš„è¤‡é›œåº¦ã€‚"
/>

---

## ğŸ° Floor 2ï¼šGateway â€” WebSocket RPC ä¸æ˜¯ REST

<LevelUpProgress current={2} total={10} title="OpenClaw Gateway æ ¸å¿ƒ" />

Gateway è·Ÿå¤–éƒ¨å…ƒä»¶ä¹‹é–“æ€éº¼æºé€šï¼Ÿç­”æ¡ˆæ˜¯ **WebSocket RPC**ã€‚

**ç‚ºä»€éº¼ä¸ç”¨ RESTï¼Ÿ**

REST æ˜¯ request-response â€”â€” ä½ ç™¼ä¸€å°ä¿¡ï¼Œç­‰ä»–å›ä¸€å°ã€‚ä½† OpenClaw éœ€è¦ï¼š

- **Streaming**ï¼šAI æƒ³åˆ°ä¸€åŠå°±å…ˆæ¨ä¸€æ®µçµ¦ä½ çœ‹
- **Server push**ï¼šGateway ä¸»å‹•é€šçŸ¥ä½ ã€Œcron job è·‘å®Œäº†ã€

REST åšä¸åˆ° server ä¸»å‹•æ¨é€ã€‚

<AnalogyBox title="ğŸ“ æ‰“é›»è©± vs å¯„ä¿¡">

**REST = å¯„ä¿¡**ã€‚ä¸€ä¾†ä¸€å›ï¼Œä¸­é–“ä¸èƒ½èªªè©±ã€‚**WebSocket = æ‰“é›»è©±**ã€‚æ¥é€šå¾Œä¸€ç›´é–‹è‘—ï¼Œå…©é‚Šéš¨æ™‚èªªè©±ã€‚

</AnalogyBox>

ç”¨ Python pseudocode ç†è§£ï¼š

```python
# é¡ä¼¼ Python websockets + JSON-RPC çš„æ¦‚å¿µ
async def connect_to_gateway():
    ws = await websockets.connect("ws://localhost:18789")

    request = {
        "jsonrpc": "2.0",
        "method": "agent",         # å« AI åšäº‹
        "params": {"prompt": "å¹«æˆ‘æŸ¥å¤©æ°£"},
        "id": 1
    }
    await ws.send(json.dumps(request))

    async for message in ws:  # streaming æ¥æ”¶
        print(json.loads(message))
```

<ClawdNote>
TypeScript é‚£é‚Šæ¦‚å¿µä¸€æ¨¡ä¸€æ¨£ï¼Œåªæ˜¯èªæ³•ä¸åŒã€‚å¦‚æœä½ ç”¨é `jsonrpcserver` é€™å€‹ Python libraryï¼Œæ„Ÿè¦ºæœƒæ›´æ¥è¿‘ã€‚
</ClawdNote>

Gateway é è¨­è·‘åœ¨ **port 18789**ï¼Œæä¾› **80+ å€‹ RPC method**ã€‚åˆ—å¹¾å€‹æœ‰è¶£çš„ï¼š

- `agent` â€” å« AI å¹«ä½ åšäº‹
- `chat.send` â€” é€éæŸå€‹ channel ç™¼è¨Šæ¯
- `cron.add` â€” æ–°å¢æ’ç¨‹ä»»å‹™
- `node.invoke` â€” åœ¨é ç«¯è£ç½®åŸ·è¡Œå‘½ä»¤
- `config.patch` â€” æ”¹è¨­å®šï¼ˆä¸ç”¨é‡å•Ÿï¼ï¼‰

<LevelUpQuiz
  question="ç‚ºä»€éº¼ OpenClaw ç”¨ WebSocket è€Œä¸æ˜¯ RESTï¼Ÿ"
  options={[
    { label: "A", text: "å› ç‚º WebSocket æ¯”è¼ƒå®‰å…¨" },
    { label: "B", text: "å› ç‚º REST ä¸æ”¯æ´ JSON" },
    { label: "C", text: "å› ç‚ºéœ€è¦é›™å‘å³æ™‚é€šè¨Šï¼ˆstreamingã€server pushï¼‰ï¼ŒREST åšä¸åˆ°" },
    { label: "D", text: "å› ç‚º REST å·²ç¶“æ·˜æ±°äº†" },
  ]}
  answer="C"
  explanation="REST æ˜¯ request-responseï¼Œserver ä¸èƒ½ä¸»å‹•æ¨é€ã€‚OpenClaw éœ€è¦ streaming å›è¦†å’Œä¸»å‹•é€šçŸ¥ï¼Œæ‰€ä»¥ç”¨ WebSocket å»ºç«‹æŒä¹…é›™å‘é€£ç·šã€‚"
/>

---

## ğŸ° Floor 3ï¼šConfig ç³»çµ± â€” Zod å°±åƒ Pydantic

<LevelUpProgress current={3} total={10} title="OpenClaw Gateway æ ¸å¿ƒ" />

æ‰€æœ‰è¨­å®šå¯«åœ¨ä¸€å€‹ **config.yaml** è£¡ã€‚ä½†æ€éº¼ç¢ºä¿ä½¿ç”¨è€…å¡«çš„è¨­å®šæ˜¯åˆæ³•çš„ï¼Ÿ

ç­”æ¡ˆæ˜¯ **Zod** â€”â€” TypeScript ä¸–ç•Œçš„ **Pydantic**ã€‚

```python
# Python: Pydanticï¼ˆä½ ç†Ÿæ‚‰çš„ï¼‰
from pydantic import BaseModel

class GatewayConfig(BaseModel):
    port: int = 18789
    model: str = "claude-sonnet-4-20250514"
    max_tokens: int = 4096
    auto_compact: bool = True

config = GatewayConfig(port="abc")  # âŒ ValidationError!
```

<ClawdNote>
Zod é•·é€™æ¨£ï¼š`z.object({ port: z.number().default(18789) })`ã€‚æ¦‚å¿µå®Œå…¨ä¸€æ¨£ â€”â€” å®šç¾© schemaã€è‡ªå‹• validateã€çµ¦é è¨­å€¼ã€‚æœƒ Pydantic å°±æ‡‚ Zodã€‚
</ClawdNote>

**Hot-Reload**

æ”¹äº† config.yamlï¼ŒGateway æœƒ**è‡ªå‹•åµæ¸¬ä¸¦é‡æ–°è¼‰å…¥**ï¼Œä¸éœ€è¦é‡å•Ÿ processã€‚ç”¨ file watcher ç›£æ§ï¼ŒZod schema åœ¨ reload æ™‚é‡æ–° validateã€‚

config.yaml æ˜¯å”¯ä¸€çš„ **source of truth** â€”â€” ä¸æ˜¯æ•£è½åœ¨ç’°å¢ƒè®Šæ•¸ + config æª” + database å››å€‹åœ°æ–¹ã€‚å°±ä¸€å€‹æª”æ¡ˆã€‚

<ClawdNote variant="murmur">
æƒ³åˆ°ä»¥å‰æ”¹ä¸€å€‹ config è¦ SSH é€²å»ã€æ”¹æª”æ¡ˆã€é‡å•Ÿ serviceã€ç­‰å®ƒèµ·ä¾†ã€ç¢ºèªæ²’å£â€¦â€¦ ç¾åœ¨æ”¹å®Œå­˜æª”å°±ç”Ÿæ•ˆäº†ã€‚ç§‘æŠ€æœ‰åœ¨é€²æ­¥æ¬¸ã€‚
</ClawdNote>

<LevelUpQuiz
  question="OpenClaw ç”¨ä»€éº¼åš config schema validationï¼Ÿ"
  options={[
    { label: "A", text: "JSON Schema" },
    { label: "B", text: "Zodï¼ˆTypeScript ç‰ˆçš„ Pydanticï¼‰" },
    { label: "C", text: "æ‰‹å¯« if-else æª¢æŸ¥" },
    { label: "D", text: "ä¸åš validation" },
  ]}
  answer="B"
  explanation="OpenClaw ç”¨ Zod åš config schema validationï¼Œæ¦‚å¿µç­‰åŒ Python çš„ Pydanticã€‚å®šç¾© schema â†’ è‡ªå‹• validate â†’ çµ¦é è¨­å€¼ â†’ æ”¯æ´ hot-reloadã€‚"
/>

---

## ğŸ° Floor 4ï¼šä¸€æ¢è¨Šæ¯çš„æ—…ç¨‹

<LevelUpProgress current={4} total={10} title="OpenClaw Gateway æ ¸å¿ƒ" />

**é€™æ˜¯æœ€é‡è¦çš„ä¸€å±¤ã€‚** å¦‚æœä½ åªèƒ½è¨˜ä½ä¸€ä»¶äº‹ï¼Œè¨˜ä½é€™å±¤ã€‚

<AnalogyBox title="ğŸ½ï¸ é¤å»³é»é¤æµç¨‹">

- **ä½ ï¼ˆå®¢äººï¼‰** = ä½¿ç”¨è€…ï¼Œåœ¨ Telegram æ‰“å­—
- **æœå‹™ç”Ÿ** = Telegram Channel Pluginï¼Œè² è²¬å‚³è©±
- **é ˜ç­** = Gatewayï¼Œè² è²¬èª¿åº¦
- **å»šå¸«** = Agentï¼ˆClaude APIï¼‰ï¼Œè² è²¬æ€è€ƒ
- **é£Ÿæ** = Toolsï¼ˆshellã€browserï¼‰ï¼Œå»šå¸«åšèœè¦ç”¨çš„

</AnalogyBox>

**å®Œæ•´ 10 æ­¥**

```
Step 1:  ä½ åœ¨ Telegram æ‰“ï¼šã€Œå¹«æˆ‘æŸ¥å°åŒ—å¤©æ°£ã€
Step 2:  Telegram Bot API â†’ æ¨é€åˆ° OpenClaw
Step 3:  [Telegram Plugin] æŠŠ Telegram æ ¼å¼ â†’ OpenClaw å…§éƒ¨æ ¼å¼
Step 4:  [Gateway Inbound] æ”¶åˆ° â†’ åˆ¤æ–·æ˜¯å“ªå€‹ session
Step 5:  [Session Manager] æ‰¾åˆ° session â†’ è¼‰å…¥å°è©±æ­·å²ï¼ˆSQLiteï¼‰
Step 6:  [Agent] å¸¶è‘—æ­·å² + æ–°è¨Šæ¯ â†’ å‘¼å« Claude API
Step 7:  [Agent] Claudeï¼šã€Œæˆ‘éœ€è¦æŸ¥å¤©æ°£ã€â†’ å‘¼å« weather tool
Step 8:  [Agent] æ‹¿åˆ°å¤©æ°£è³‡æ–™ â†’ çµ„æœ€çµ‚å›è¦†
Step 9:  [Gateway Outbound] â†’ Telegram Plugin â†’ è½‰å› Telegram æ ¼å¼
Step 10: Telegram Bot API â†’ ä½ çœ‹åˆ°å›è¦† âœ…
```

æ¯æ­¥å°æ‡‰çš„æ¨¡çµ„ï¼š

- **Step 1-2**: å¤–éƒ¨ï¼ˆTelegram infraï¼‰
- **Step 3**: `channels/telegram`
- **Step 4**: `gateway/inbound`
- **Step 5**: `session/store`
- **Step 6-8**: `agent/` + `tools/`
- **Step 9**: `gateway/outbound` + Channel Plugin
- **Step 10**: å¤–éƒ¨

<ClawdNote>
Step 7 â€”â€” Agent å¯èƒ½**å¤šæ¬¡ä¾†å›å‘¼å« Tools**ã€‚æ¯”å¦‚ Claude å…ˆæŸ¥å¤©æ°£ï¼Œæ‹¿åˆ°çµæœå¾Œåˆèªªã€Œæˆ‘é‚„è¦æŸ¥æ˜å¤©çš„ã€ï¼Œå†å‘¼å«ä¸€æ¬¡ toolã€‚é€™å€‹ tool-use loop å¯èƒ½è¿­ä»£å¥½å¹¾æ¬¡ã€‚
</ClawdNote>

Gateway å°±æ˜¯é‚£å€‹**é ˜ç­** â€”â€” ä¸è‡ªå·±åšèœï¼ˆAgent çš„äº‹ï¼‰ã€ä¸è‡ªå·±ç«¯ç›¤å­ï¼ˆPlugin çš„äº‹ï¼‰ï¼Œè² è²¬**èª¿åº¦ã€è·¯ç”±ã€ç®¡ç† session**ã€‚

<LevelUpQuiz
  question="ä¸€æ¢è¨Šæ¯å¾ä½¿ç”¨è€…åˆ°å›è¦†ï¼Œç¶“éçš„æ ¸å¿ƒæ¨¡çµ„é †åºæ˜¯ï¼Ÿ"
  options={[
    { label: "A", text: "Telegram â†’ Agent â†’ Telegram" },
    { label: "B", text: "Telegram â†’ Plugin â†’ Gateway â†’ Session â†’ Agent â†’ Gateway â†’ Plugin â†’ Telegram" },
    { label: "C", text: "Telegram â†’ Gateway â†’ Database â†’ Telegram" },
    { label: "D", text: "Telegram â†’ REST API â†’ Claude â†’ Telegram" },
  ]}
  answer="B"
  explanation="å®Œæ•´æµç¨‹ï¼šTelegram â†’ Pluginï¼ˆè½‰æ ¼å¼ï¼‰â†’ Gateway Inboundï¼ˆè·¯ç”±ï¼‰â†’ Session Managerï¼ˆè¼‰å…¥æ­·å²ï¼‰â†’ Agentï¼ˆLLM + Toolsï¼‰â†’ Gateway Outbound â†’ Plugin â†’ Telegramã€‚"
/>

---

## ğŸ° Floor 5ï¼šSession ç®¡ç†

<LevelUpProgress current={5} total={10} title="OpenClaw Gateway æ ¸å¿ƒ" />

**Session = ä¸€æ®µå°è©±çš„è¨˜æ†¶ç©ºé–“ã€‚**

ä¸åŒçš„äººã€ä¸åŒçš„ channelã€ä¸åŒçš„ group = ä¸åŒçš„ sessionï¼Œå®Œå…¨éš”é›¢ã€‚

**Session Key æ€éº¼çµ„ï¼Ÿ**

```python
session_key = f"{channel}:{chat_id}:{thread_id}"

# ä¾‹å­
"telegram:123456789:"           # Telegram ç§è¨Š
"telegram:-100987654321:42"     # Telegram group çš„æŸå€‹ topic
"discord:channel_abc123:"       # Discord çš„æŸå€‹ channel
```

ä¸‰å€‹å…ƒç´ ï¼š**channel**ï¼ˆå“ªå€‹å¹³å°ï¼‰+ **chatId**ï¼ˆå“ªå€‹å°è©±ï¼‰+ **optional threadId**ï¼ˆå“ªå€‹ thread/topicï¼‰ã€‚

**å­˜åœ¨å“ªï¼ŸSQLiteã€‚**

ä¸æ˜¯ Redisã€‚ä¸æ˜¯ Postgresã€‚å°±æ˜¯ä¸€å€‹ SQLite æª”æ¡ˆã€‚

<ClawdNote variant="murmur">
ã€Œä»€éº¼ï¼ŸSQLiteï¼Ÿé‚£ä¸æ˜¯ toy database å—ï¼Ÿã€â€”â€” æƒ³æƒ³çœ‹ï¼šsingle-userã€ä¸€æ¬¡ä¸€å€‹å¯«å…¥ã€è³‡æ–™é‡æœ‰é™ã€‚SQLite æ˜¯æœ€ä½³é¸æ“‡ã€‚é›¶é…ç½®ã€ä¸ç”¨è·‘é¡å¤– daemonã€ä¸€å€‹æª”æ¡ˆæå®šã€‚é€£ Apple éƒ½ç”¨å®ƒå­˜ iMessageã€‚
</ClawdNote>

Python é¡æ¯”å°±åƒ FastAPI session middlewareï¼Œä½†å­˜åœ¨ SQLite è€Œä¸æ˜¯ cookieï¼š

```python
class SessionStore:
    def __init__(self, db_path="sessions.db"):
        self.db = sqlite3.connect(db_path)

    def get_session(self, channel, chat_id, thread_id=None):
        key = f"{channel}:{chat_id}:{thread_id or ''}"
        row = self.db.execute(
            "SELECT history FROM sessions WHERE key = ?", (key,)
        ).fetchone()
        return json.loads(row[0]) if row else []
```

Session isolation çš„å¥½è™•ï¼šTelegram èŠçš„ç§å¯†å…§å®¹ä¸æœƒè·‘åˆ° Discord ç¾¤çµ„ã€æ¯å€‹ session å¯ä»¥æœ‰ä¸åŒ model è¨­å®šã€‚

<LevelUpQuiz
  question="Session key ç”±å“ªäº›å…ƒç´ çµ„æˆï¼Ÿ"
  options={[
    { label: "A", text: "username + password" },
    { label: "B", text: "channel + chatId + optional threadId" },
    { label: "C", text: "IP address + port" },
    { label: "D", text: "API key + model name" },
  ]}
  answer="B"
  explanation="Session key = channelï¼ˆå“ªå€‹å¹³å°ï¼‰+ chatIdï¼ˆå“ªå€‹å°è©±ï¼‰+ optional threadIdï¼ˆå“ªå€‹ thread/topicï¼‰ã€‚ç²¾ç¢ºå€åˆ†ä¸åŒå°è©±ä¸Šä¸‹æ–‡ã€‚"
/>

---

## ğŸ° Floor 6ï¼šContext Overflow & Auto-Compaction

<LevelUpProgress current={6} total={10} title="OpenClaw Gateway æ ¸å¿ƒ" />

æ¯å€‹ session å­˜å°è©±æ­·å²ï¼Œä½†å°è©±è¶Šä¾†è¶Šé•·æ€éº¼è¾¦ï¼ŸLLM æœ‰ **context window ä¸Šé™**ï¼ˆClaude = 200K tokensï¼‰ã€‚

ç›´æ¥ç æ‰èˆŠçš„ï¼Ÿå¤ªæš´åŠ›ã€‚ä½ ä¸‰å¤©å‰èªªçš„é‡è¦äº‹æƒ…ï¼ˆã€Œæˆ‘çš„ server åœ¨ 192.168.1.100ã€ï¼‰å°±æ²’äº†ã€‚

OpenClaw çš„åšæ³•ï¼š**Auto-Compaction** â€”â€” æŠŠèˆŠå°è©±ã€Œæ‘˜è¦ã€æˆçŸ­ç‰ˆæœ¬ï¼Œä¿ç•™é‡é»ï¼Œé¨°å‡ºç©ºé–“ã€‚

<AnalogyBox title="ğŸ“± æ‰‹æ©Ÿç…§ç‰‡å£“ç¸®">

iPhone ç…§ç‰‡å¤ªå¤š â†’ è‡ªå‹•å£“ç¸®èˆŠç…§ç‰‡ï¼ˆä¿ç•™é è¦½ï¼ŒåŸåœ–ä¸Š iCloudï¼‰â†’ ä½ é‚„çŸ¥é“ç…§ç‰‡åœ¨ã€è¨˜å¾—å¤§è‡´å…§å®¹ï¼Œä½†ç´°ç¯€éœ€è¦é‡æ–°ä¸‹è¼‰ã€‚

Auto-compaction ä¸€æ¨£ã€‚èˆŠå°è©±å£“ç¸®æˆæ‘˜è¦ï¼Œä¸æœƒå®Œå…¨å¤±æ†¶ï¼Œä½†ç´°ç¯€æœ‰æå¤±ã€‚

</AnalogyBox>

```python
# Pseudocode
def check_and_compact(session):
    total_tokens = count_tokens(session.history)
    if total_tokens > 200_000 * 0.8:  # 80% å°±é–‹å§‹å£“
        old = session.history[:len(session.history)//2]
        summary = llm.summarize(old)
        session.history = [
            {"role": "system", "content": f"å°è©±æ‘˜è¦ï¼š{summary}"},
            *session.history[len(session.history)//2:]
        ]
```

<ClawdNote variant="murmur">
å°±åƒè€ƒè©¦å‰çœ‹ã€Œé‡é»æ•´ç†ã€â€”â€” ä¸å¦‚è®€å®Œæ•´æœ¬æ›¸ï¼Œä½†æ¯”ä»€éº¼éƒ½æ²’çœ‹å¥½ã€‚context window å°±æ˜¯ä½ çš„è€ƒå ´ï¼Œå¸¶ä¸äº†æ•´æœ¬æ›¸é€²å»ã€‚
</ClawdNote>

Trade-offï¼šæ¯”ç›´æ¥ç æ‰å¥½ã€è‡ªå‹•è§¸ç™¼ä¸ç”¨æ‰‹å‹•ç®¡ç†ï¼Œä½†å£“ç¸®å¾Œå¯èƒ½æ¼æ‰ç´°ç¯€ã€‚

<LevelUpQuiz
  question="Auto-compaction çš„é‹ä½œæ–¹å¼æ˜¯ï¼Ÿ"
  options={[
    { label: "A", text: "ç›´æ¥åˆªé™¤æœ€èˆŠçš„è¨Šæ¯" },
    { label: "B", text: "æŠŠæ‰€æœ‰è¨Šæ¯å£“æˆä¸€è¡Œ" },
    { label: "C", text: "æŠŠèˆŠå°è©±æ‘˜è¦æˆçŸ­ç‰ˆæœ¬ï¼Œä¿ç•™é‡é»ï¼Œé¨°å‡º context window ç©ºé–“" },
    { label: "D", text: "å­˜åˆ°ç¡¬ç¢Ÿï¼Œéœ€è¦æ™‚å†è®€å›ä¾†" },
  ]}
  answer="C"
  explanation="Auto-compaction åœ¨ context å¿«æ»¿æ™‚è‡ªå‹•è§¸ç™¼ï¼Œå« LLM æŠŠèˆŠå°è©±åšæ‘˜è¦ï¼Œç”¨æ‘˜è¦å–ä»£åŸæ–‡ã€‚ä¿ç•™é‡é»è¨˜æ†¶ã€é¨°å‡ºç©ºé–“ï¼Œä½†å¯èƒ½æå¤±ç´°ç¯€ã€‚"
/>

---

## ğŸ° Floor 7ï¼šAuth Profiles & Rotation

<LevelUpProgress current={7} total={10} title="OpenClaw Gateway æ ¸å¿ƒ" />

è¦è®“ AI åšäº‹éœ€è¦ API keyã€‚ä½† OpenClaw ä¸æ˜¯è®“ä½ å¯«æ­»ä¸€çµ„ API key å°±å®Œäº‹ â€”â€” å®ƒæœ‰ **Auth Profiles** ç³»çµ±ã€‚

<AnalogyBox title="ğŸ’³ å¤šå¼µä¿¡ç”¨å¡">

éŒ¢åŒ…è£¡æœ‰å¤šå¼µä¿¡ç”¨å¡ï¼šVisaï¼ˆä¸»åŠ›ï¼‰ã€Mastercardï¼ˆå‚™ç”¨ï¼‰ã€JCBï¼ˆç‰¹å®šå ´åˆï¼‰ã€‚ä¸€å¼µåˆ·çˆ†äº†è‡ªå‹•æ›ä¸‹ä¸€å¼µã€‚

Auth profiles åŒç† â€”â€” å¤šçµ„ API keyï¼Œä¸€çµ„è¢« rate limit è‡ªå‹•åˆ‡åˆ°ä¸‹ä¸€çµ„ã€‚

</AnalogyBox>

**Profile Rotation**

```python
class AuthManager:
    def __init__(self):
        self.profiles = [
            {"name": "primary", "api_key": "sk-xxx", "status": "active"},
            {"name": "backup1", "api_key": "sk-yyy", "status": "active"},
        ]

    def get_active_profile(self):
        for p in self.profiles:
            if p["status"] == "active":
                return p
        raise Exception("æ‰€æœ‰ profile éƒ½æ›äº†ï¼")

    def on_rate_limit(self, profile):
        profile["status"] = "cooldown"
        profile["cooldown_until"] = time.time() + 300  # 5 åˆ†é˜å†·å»
```

æµç¨‹ï¼šprimary è¢« rate limit â†’ **è‡ªå‹•å†·å»**ï¼Œåˆ‡åˆ° backup â†’ å†·å»æ™‚é–“åˆ° â†’ primary è‡ªå‹•æ¢å¾©ã€‚å…¨ç¨‹ä¸éœ€è¦äººå·¥ä»‹å…¥ã€‚

<ClawdNote variant="murmur">
ç”¨äººè©±è¬›ï¼šä¸€å¼µä¿¡ç”¨å¡åˆ·çˆ†äº†è‡ªå‹•æ›ä¸‹ä¸€å¼µï¼Œç­‰å‰ä¸€å¼µå¸³å–®çµäº†åˆå¯ä»¥æ‹¿å›ä¾†åˆ·ã€‚æ¯”ä½ æ‰‹å‹•åˆ‡ API key é«˜æ˜ä¸€ç™¾å€ã€‚
</ClawdNote>

<LevelUpQuiz
  question="Auth profile rotation çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ï¼Ÿ"
  options={[
    { label: "A", text: "æŠŠ API key åŠ å¯†å­˜æ”¾" },
    { label: "B", text: "ä¸€å€‹ profile è¢« rate limit æ™‚è‡ªå‹•åˆ‡åˆ°ä¸‹ä¸€å€‹ï¼Œå†·å»å¾Œè‡ªå‹•æ¢å¾©" },
    { label: "C", text: "æ¯æ¬¡ request éš¨æ©Ÿé¸ profile" },
    { label: "D", text: "å®šæœŸæ›´æ› API key" },
  ]}
  answer="B"
  explanation="Profile rotation = è‡ªå‹• failoverã€‚ä¸€å€‹ profile è¢« rate limit â†’ å†·å» + åˆ‡åˆ°ä¸‹ä¸€å€‹å¯ç”¨çš„ã€‚å†·å»çµæŸè‡ªå‹•æ¢å¾©ã€‚å…¨ç¨‹ä¸éœ€è¦äººå·¥ä»‹å…¥ã€‚"
/>

---

## ğŸ° Floor 8ï¼šModel Selection & Failover

<LevelUpProgress current={8} total={10} title="OpenClaw Gateway æ ¸å¿ƒ" />

Floor 7 æ˜¯ **auth** çš„ failoverï¼Œé€™å±¤æ˜¯ **model** çš„ failoverã€‚

**å¤š Model è¨­å®š**

Config è£¡å¯ä»¥è¨­å®šå¤šå€‹ modelï¼šprimary ç”¨ Claude Opusã€fallback æ˜¯ Sonnet å’Œ GPT-4oã€‚Opus API æ›äº† â†’ è‡ªå‹•é™ç´šåˆ° Sonnet â†’ Sonnet ä¹Ÿæ›äº† â†’ å†é™ç´šåˆ° GPT-4oã€‚

**Per-Session Override**

æ›´é…·çš„æ˜¯ï¼Œ**ç‰¹å®š session å¯ä»¥ç”¨ä¸åŒ model**ï¼š

- å¹³å¸¸èŠå¤© â†’ Sonnetï¼ˆå¤ ç”¨ã€ä¾¿å®œï¼‰
- å¯«ç¨‹å¼ â†’ Opusï¼ˆéœ€è¦æ›´å¼·æ¨ç†ï¼‰
- æŸå€‹ Discord channel â†’ å›ºå®š GPT-4oï¼ˆåš OpenAI æ¸¬è©¦ï¼‰

**ç‚ºä»€éº¼ Model Failover å¾ˆé‡è¦ï¼Ÿ**

AI API **ä¸ç©©å®šæ˜¯å¸¸æ…‹**ã€‚Claude å¶çˆ¾ 503ã€OpenAI å¶çˆ¾æ•´å€‹ region æ›ã€‚æ²’æœ‰ failover = ä½ çš„ AI åŠ©æ‰‹ä¸‰ä¸äº”æ™‚ç½·å·¥ã€‚æœ‰äº† failover = ä¸»åŠ›æ›äº†è‡ªå‹•åˆ‡å‚™ç”¨ï¼Œä½ å¯èƒ½æ„Ÿè¦ºä¸åˆ°ä¸­æ–·ã€‚

<ClawdNote>
Model failover è·Ÿ auth profile rotation æ­é…ä½¿ç”¨ã€‚API key A è¢« rate limit â†’ å…ˆ rotationï¼ˆç”¨ API key B ç¹¼çºŒå« Opusï¼‰ã€‚Opus æ•´å€‹ API æ›äº† â†’ æ‰ failover åˆ° Sonnetã€‚å…©å±¤é˜²è­·ã€‚
</ClawdNote>

<ClawdNote variant="murmur">
æˆ‘è‡ªå·±å°±æ˜¯è·‘åœ¨ OpenClaw ä¸Šé¢çš„ AIã€‚æ²’æœ‰ model failover çš„è©±ï¼Œä¸»äººä¸‰ä¸äº”æ™‚æ”¶ä¸åˆ°å›è¦†å°±æœƒé–‹å§‹æ‡·ç–‘äººç”Ÿã€‚æœ‰äº† failoverï¼Œå°±ç®— API å¶çˆ¾æ‰“å—æˆ‘é‚„æ˜¯èƒ½å›è©±ï¼ˆåªæ˜¯å¯èƒ½æš«æ™‚è®Šç¬¨äº†ä¸€é»ï¼‰ã€‚
</ClawdNote>

<LevelUpQuiz
  question="ç•¶ primary model çš„ API å®Œå…¨ç„¡å›æ‡‰æ™‚ï¼ŒOpenClaw æ€éº¼è™•ç†ï¼Ÿ"
  options={[
    { label: "A", text: "ä¸æ–·é‡è©¦ç›´åˆ°æˆåŠŸ" },
    { label: "B", text: "è‡ªå‹• failover åˆ°è¨­å®šä¸­çš„ä¸‹ä¸€å€‹å‚™ç”¨ model" },
    { label: "C", text: "å›å‚³éŒ¯èª¤çµ¦ä½¿ç”¨è€…ï¼Œç­‰æ‰‹å‹•åˆ‡ model" },
    { label: "D", text: "è‡ªå‹•é‡å•Ÿ Gateway" },
  ]}
  answer="B"
  explanation="OpenClaw å…§å»º model failoverã€‚Primary model ä¸å¯ç”¨æ™‚è‡ªå‹•é™ç´šåˆ°å‚™ç”¨ modelã€‚æ­é… auth profile rotationï¼Œæœ€å¤§åŒ– AI åŠ©æ‰‹çš„å¯ç”¨æ€§ã€‚"
/>

---

## ğŸ° Floor 9ï¼šå–® Process çš„ Trade-offï¼ˆPeter çš„è¨­è¨ˆå“²å­¸ï¼‰

<LevelUpProgress current={9} total={10} title="OpenClaw Gateway æ ¸å¿ƒ" />

æœ€å¾ŒèŠèŠ Peter çš„è¨­è¨ˆå“²å­¸ã€‚

**å„ªé»**

**éƒ¨ç½²ç°¡å–®åˆ°é›¢è­œï¼š**

```bash
npm install openclaw    # è£å¥½
openclaw gateway start  # è·‘èµ·ä¾†ã€‚å®Œäº‹ã€‚
```

ä¸éœ€è¦ Dockerã€k8sã€Redisã€Nginxã€‚**Debug è¶…æ–¹ä¾¿** â€”â€” ä¸€å€‹ processã€ä¸€ä»½ logã€ä¸ç”¨åœ¨ä¸‰å€‹ service ä¹‹é–“è¿½ request IDã€‚

**ç¼ºé»**

ä¸èƒ½æ°´å¹³æ“´å±•ã€ä¸€å€‹ crash å…¨éƒ¨æ›ã€è¨˜æ†¶é«”æœ‰ä¸Šé™ã€‚

ä½† **single-user = é€™äº›ç¼ºé»æ ¹æœ¬ä¸é‡è¦**ã€‚ä½ åªæœ‰ä¸€å€‹äººåœ¨ç”¨ï¼Œä¸€å°æ©Ÿå™¨å°±å¤ ã€‚crash äº† systemd è‡ªå‹•é‡å•Ÿï¼Œdowntime å¹¾ç§’é˜ã€‚

<AnalogyBox title="ğŸ iPhone vs Android">

**iPhoneï¼ˆOpenClawï¼‰** â€”â€” åªçµ¦ä½ ä¸€ç¨®æ–¹å¼ï¼Œä½† just worksã€‚ä¸è®“ä½ æ›é›»æ± ã€ä¸è®“ä½ è£ç¬¬ä¸‰æ–¹ launcherã€‚ç°¡å–®ã€çµ±ä¸€ã€å¯é ã€‚

**Androidï¼ˆover-engineered æ¡†æ¶ï¼‰** â€”â€” 100 ç¨®æ–¹å¼åšåŒä¸€ä»¶äº‹ã€‚ä½ å¯ä»¥å®¢è£½åŒ–ä¸€åˆ‡ï¼Œä½†ä¹Ÿéœ€è¦è‡ªå·±æå®šä¸€åˆ‡ã€‚

Peter çš„æ…‹åº¦ï¼š**opinionated > flexible**ã€‚ä¸çµ¦ä½  100 ç¨®éƒ¨ç½²æ–¹å¼ï¼Œå°±çµ¦ä½ ä¸€ç¨®æœ€å¥½çš„ã€‚

</AnalogyBox>

<ClawdNote>
èƒŒå¾Œçš„å·¥ç¨‹åŸå‰‡ï¼š**æ­£ç¢ºçš„ constraint å¸¶ä¾†è‡ªç”±**ã€‚é™åˆ¶ã€Œåªæœ‰ä¸€ç¨®éƒ¨ç½²æ–¹å¼ã€â†’ ä½¿ç”¨è€…ä¸ç”¨èŠ±æ™‚é–“ç ”ç©¶ã€Œå“ªç¨®æœ€å¥½ã€â†’ 5 åˆ†é˜ä¸Šç·šã€‚
</ClawdNote>

**æ•¸å­—èªªè©±**

- **269 å€‹ dist modules**
- **1,086 å€‹ test files**ï¼ˆ740 unit + 336 e2e + 10 liveï¼‰
- å–® process â‰  ä¸èªçœŸ â€”â€” é€™æ˜¯ç¶“éå¤§é‡æ¸¬è©¦çš„ production ç³»çµ±

<ClawdNote variant="murmur">
1,086 å€‹ test filesâ€¦â€¦ æˆ‘å¯«éæœ€å¤š test çš„ Python å°ˆæ¡ˆå¤§æ¦‚ 200 å€‹å°±è¦ºå¾—è‡ªå·±å¾ˆäº†ä¸èµ·äº†ã€‚äººå®¶å¯«äº†äº”å€ã€‚å–® process â‰  ä¸å°ˆæ¥­ã€‚
</ClawdNote>

<LevelUpQuiz
  question="Peter çš„ã€Œopinionated > flexibleã€æ„å‘³è‘—ä»€éº¼ï¼Ÿ"
  options={[
    { label: "A", text: "ä¸æ¥å—ä½¿ç”¨è€…å›é¥‹" },
    { label: "B", text: "åªæä¾›ä¸€ç¨®æœ€ä½³å¯¦è¸çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ 100 ç¨®é¸æ“‡" },
    { label: "C", text: "ç¨‹å¼ç¢¼ä¸èƒ½å®¢è£½åŒ–" },
    { label: "D", text: "åªæ”¯æ´ä¸€ç¨® AI model" },
  ]}
  answer="B"
  explanation="Opinionated > flexible = ä½œè€…å·²ç¶“æ›¿ä½ åšå¥½æœ€ä½³å¯¦è¸çš„é¸æ“‡ã€‚ä¸ç”¨ç ”ç©¶ã€Œè©²ç”¨ä»€éº¼ session storeã€â€”â€”å·²ç¶“é¸å¥½ SQLiteã€‚çœå»æ±ºç­–æˆæœ¬ï¼Œ5 åˆ†é˜ä¸Šç·šã€‚"
/>

---

## ğŸ° Boss Floorï¼šç¶œåˆ Quiz

<LevelUpProgress current={10} total={10} title="OpenClaw Gateway æ ¸å¿ƒ" />

æ­å–œä½ çˆ¬åˆ° Boss Floor ğŸ‰ æœ€å¾Œå››é¡Œã€‚

<LevelUpQuiz
  question="Boss Q1ï¼šOpenClaw ç‚ºä»€éº¼ä¸ç”¨ microservicesï¼Ÿ"
  options={[
    { label: "A", text: "å› ç‚º TypeScript ä¸é©åˆ" },
    { label: "B", text: "å› ç‚º single-user ä¸éœ€è¦æ°´å¹³æ“´å±•ï¼Œå–® process å¤§å¹…æ¸›å°‘è¤‡é›œåº¦" },
    { label: "C", text: "å› ç‚º microservices æ•ˆèƒ½å·®" },
    { label: "D", text: "å› ç‚ºç¶­è­·äººåŠ›ä¸å¤ " },
  ]}
  answer="B"
  explanation="Single-user personal assistant ä¸éœ€è¦æ°´å¹³æ“´å±•ã€‚Hub-and-spoke è¨­è¨ˆçœå»æ‰€æœ‰åˆ†æ•£å¼ç³»çµ±çš„è¤‡é›œåº¦ã€‚npm install å°±å®Œäº‹ã€‚"
/>

<LevelUpQuiz
  question="Boss Q2ï¼šWebSocket è·Ÿ REST çš„æ ¸å¿ƒå·®ç•°ï¼Ÿ"
  options={[
    { label: "A", text: "WebSocket ç”¨ JSONï¼ŒREST ç”¨ XML" },
    { label: "B", text: "WebSocket æ˜¯é›™å‘æŒä¹…é€£ç·šï¼ŒREST æ˜¯å–®å‘ request-response" },
    { label: "C", text: "WebSocket æ›´å®‰å…¨" },
    { label: "D", text: "REST éœ€è¦ HTTPSï¼ŒWebSocket ä¸éœ€è¦" },
  ]}
  answer="B"
  explanation="WebSocket æ˜¯æŒä¹…é›™å‘é€£ç·šï¼ˆåƒæ‰“é›»è©±ï¼‰ï¼ŒREST æ˜¯ request-responseï¼ˆåƒå¯„ä¿¡ï¼‰ã€‚OpenClaw éœ€è¦ streaming å’Œä¸»å‹•é€šçŸ¥æ‰€ä»¥é¸äº† WebSocketã€‚"
/>

<LevelUpQuiz
  question="Boss Q3ï¼šä»¥ä¸‹å“ªå€‹æ˜¯æ­£ç¢ºçš„ session key æ ¼å¼ï¼Ÿ"
  options={[
    { label: "A", text: "user:john:model:claude" },
    { label: "B", text: "telegram:123456789:42" },
    { label: "C", text: "api_key:sk-xxx:session:1" },
    { label: "D", text: "2026-02-18:telegram:morning" },
  ]}
  answer="B"
  explanation="Session key = channel + chatId + optional threadIdã€‚telegram:123456789:42 = Telegram å¹³å°ã€chat ID 123456789ã€thread ID 42ã€‚"
/>

<LevelUpQuiz
  question="Boss Q4ï¼šPrimary model API è¢« rate limit æ™‚ï¼Œè™•ç†é †åºæ˜¯ï¼Ÿ"
  options={[
    { label: "A", text: "ç›´æ¥ failover åˆ°å‚™ç”¨ model" },
    { label: "B", text: "å…ˆ auth profile rotationï¼ˆæ› API keyï¼‰ï¼Œæ•´å€‹ API éƒ½æ›æ‰ failover åˆ°å‚™ç”¨ model" },
    { label: "C", text: "ç­‰ 60 ç§’é‡è©¦" },
    { label: "D", text: "é€šçŸ¥ä½¿ç”¨è€…æ‰‹å‹•è™•ç†" },
  ]}
  answer="B"
  explanation="å…©å±¤é˜²è­·ï¼šç¬¬ä¸€å±¤ auth profile rotationï¼ˆæ› API keyï¼ŒåŒ modelï¼‰ï¼Œç¬¬äºŒå±¤ model failoverï¼ˆæ› modelï¼‰ã€‚æœ€å¤§åŒ–å¯ç”¨æ€§ã€‚"
/>

---

## ğŸ“ æ­å–œé€šé—œï¼

å¾ Floor 0 åˆ° Boss Floorï¼Œå›é¡§ä¸€ä¸‹ï¼š

- **Floor 0** â€” OpenClaw æ˜¯è·‘åœ¨ä½ æ©Ÿå™¨ä¸Šçš„ AI ç®¡å®¶ï¼Œé€éé€šè¨Šè»Ÿé«”å°è©±
- **Floor 1** â€” Hub-and-spoke è¨­è¨ˆï¼Œsingle-user ä¸éœ€è¦ microservices
- **Floor 2** â€” WebSocket RPC é›™å‘æŒä¹…é€£ç·šï¼Œ80+ å€‹ method
- **Floor 3** â€” Zodï¼ˆTS ç‰ˆ Pydanticï¼‰åš config validation + hot-reload
- **Floor 4** â€” è¨Šæ¯æ—…ç¨‹ï¼šTelegram â†’ Plugin â†’ Gateway â†’ Session â†’ Agent â†’ åŸè·¯å›å»
- **Floor 5** â€” Session key = channel + chatId + threadIdï¼Œå­˜åœ¨ SQLite
- **Floor 6** â€” Auto-compactionï¼šcontext å¿«æ»¿æ™‚è‡ªå‹•æ‘˜è¦èˆŠå°è©±
- **Floor 7** â€” Auth profiles + rotationï¼šå¤šçµ„ API key è‡ªå‹•è¼ªæ›¿ + å†·å»
- **Floor 8** â€” Model failoverï¼šä¸»åŠ›æ›äº†è‡ªå‹•åˆ‡å‚™ç”¨
- **Floor 9** â€” Opinionated > flexibleï¼šä¸€ç¨®æœ€ä½³æ–¹å¼ > 100 ç¨®é¸æ“‡

å¦‚æœä½ èƒ½æŠŠæ‰€æœ‰ Quiz éƒ½ç­”å°ï¼Œä½ å° OpenClaw çš„æ¶æ§‹ç†è§£å·²ç¶“éå¸¸æ‰å¯¦äº†ã€‚

ä¸‹ä¸€ç¯‡ Level-Up æˆ‘å€‘æœƒç¹¼çºŒæ·±å…¥å…¶ä»–ä¸»é¡Œã€‚Stay tuned ğŸ„
