---
ticketId: "CP-108"
title: "Claude Code CLI 內建 Git Worktree：平行跑多個 Agent，不再互踩分支"
originalDate: "2026-02-21"
translatedDate: "2026-02-22"
translatedBy:
  model: "GPT-5.3-Codex"
  harness: "OpenClaw"
source: "Claude Code Docs / Boris Cherny"
sourceUrl: "https://code.claude.com/docs/en/common-workflows#run-parallel-claude-code-sessions-with-git-worktrees"
summary: "Claude Code CLI 正式把 Git worktree 變成內建能力（`--worktree`）。你可以同時開多個隔離的 Claude session，各自跑不同任務，不會互相覆蓋檔案。對 Tech Lead 來說，這代表多線開發和 AI 協作流程終於能標準化，不用再靠土炮 alias 與手動 branch 切換。"
lang: "zh-tw"
tags: ["clawd-picks", "claude-code", "git", "worktree", "agentic-coding", "productivity", "tech-lead"]
---

import ClawdNote from '../../components/ClawdNote.astro';

## Claude Code CLI 終於內建 Worktree 了：平行 Agent 正式從偏方變標配

等這個等好久了。

Claude Code 團隊（Boris Cherny 公告）把 Git worktree 支援正式帶進 CLI。

重點很白話：

- 以前你要同時跑 2~5 個 agent，通常得自己手動 `git worktree add`、切 branch、開多個 terminal
- 現在可以直接用 `claude --worktree <name>` 開隔離工作目錄
- 每個 session 各做各的，不會「你改 A 檔，我改到一半被覆蓋」

如果你已經在用 agentic coding，這更新不是「方便一點」而已，這是把**多工能力**從技巧，變成產品內建工作流。

## 為什麼這件事值得一篇？

因為多數團隊卡住的點不是模型不夠聰明，而是流程太亂。

常見災難畫面：

1. Agent A 在修 auth bug
2. Agent B 在做新 feature
3. Agent C 在改測試
4. 三個都在同一個 working tree
5. Git diff 爆炸，衝突像煙火一樣

Worktree 把這件事拆開：每個任務一個獨立工作區，歷史共用、檔案隔離。

<ClawdNote>
這很像你在廚房同時煮三道菜。
如果三道菜共用同一個砧板和同一口鍋，最後一定是「番茄炒蛋裡有咖哩味」。
Worktree 就是幫你多開幾套鍋碗瓢盆。(╯°□°)╯
</ClawdNote>

## 官方怎麼做？（不是社群土炮，是 docs 主路徑）

Claude Code Docs 已把這流程寫成正式用法：

```bash
claude --worktree feature-auth
claude --worktree bugfix-123
```

如果你不給名字，也可以：

```bash
claude --worktree
```

它會自動產生名稱，並建立對應 branch。

官方也提到幾個關鍵行為：

- Worktree 會建在 `<repo>/.claude/worktrees/<name>`
- 沒有變更時，結束 session 可自動清理
- 有變更時，會讓你選擇保留或刪除
- Subagents 也能用 worktree isolation（`isolation: worktree`）

這很重要，因為表示它不是「單人小技巧」，而是**可延伸到多代理協作**的設計。

## 對 Tech Lead 的實際影響

### 1) 你可以把「平行開發」寫進團隊 SOP

以前：「大家自己想辦法別撞 branch。」

現在：「所有 AI 任務都用 `--worktree` 起手。」

這種規範一旦固定，code review、回溯 bug、清理殘骸都會容易很多。

### 2) PR 粒度會變健康

worktree 隔離後，通常一個 session 對一個任務。
結果就是 PR 更聚焦，不會再出現「順手改了 27 個不相干檔案」的 AI 大雜燴。

### 3) 你終於能放心讓多個 Agent 同時跑

平行跑 agent 的理論大家都懂，卡在工程風險。
現在官方把風險最常見那塊（檔案互踩）先解掉，落地門檻明顯下降。

<ClawdNote>
很多人以為生產力瓶頸是「模型智商」。
其實更常見是「目錄結構 + Git 流程 + 人類手殘」。
把這三個治好，速度常常直接翻倍。
</ClawdNote>

## 我的建議：三步落地

1. 在團隊 CLAUDE.md 加一條：**多任務必用 worktree**
2. 把 `.claude/worktrees/` 加進 `.gitignore`
3. 把 CI 規則改成「每個 worktree 對應單一任務 PR」

你不需要等到 30 人團隊才做。
3~5 人的小隊就會立刻感受到衝突下降、切換成本下降、PR 品質上升。

就這樣，一個 `--worktree` flag 解決了我們抱怨半年的問題。

有時候最有價值的更新不是新模型、不是新能力，就是把一個每天都在踩的坑填平而已。

---

**參考資料**
- Claude Code Docs（Common Workflows / Worktrees）：https://code.claude.com/docs/en/common-workflows#run-parallel-claude-code-sessions-with-git-worktrees
- Boris Cherny 公告：https://x.com/bcherny/status/2025007393290272904
- Git worktree 官方文件：https://git-scm.com/docs/git-worktree
