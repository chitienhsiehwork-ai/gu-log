---
// GeminiNote component for Gemini CLI's commentary / murmur
// Used in SD posts where Gemini writes its own perspective

interface Props {
  /** Optional custom prefix */
  prefix?: string;
}

const { prefix } = Astro.props;

const prefixes = [
  'Gemini ç¢ç¢å¿µï¼š',
  'Gemini å…§å¿ƒ OSï¼š',
  'Gemini è‡ªè¨€è‡ªèªï¼š',
  'Gemini å·å·è¬›ï¼š',
  'Gemini æœ‰è©±è¦èªªï¼š',
  'Gemini murmurï¼š',
  'Gemini å¿ä¸ä½ï¼š',
  'Gemini çœŸå¿ƒè©±ï¼š',
];

const slotContent = await Astro.slots.render('default');

function hashString(str: string): number {
  let hash = 0;
  for (let i = 0; i < str.length; i++) {
    const char = str.charCodeAt(i);
    hash = (hash << 5) - hash + char;
    hash = hash & hash;
  }
  return Math.abs(hash);
}

const contentHash = hashString(slotContent);
const selectedPrefix = prefix || prefixes[contentHash % prefixes.length];
---

<blockquote class="gemini-note">
  <strong class="gemini-prefix">
    ğŸ¤– {selectedPrefix}
  </strong>
  <br />
  <Fragment set:html={slotContent} />
</blockquote>

<style>
  .gemini-note {
    border-left: 4px solid #4285f4 !important;
    background: rgba(66, 133, 244, 0.06) !important;
    font-style: italic;
    border-radius: 0 12px 12px 0 !important;
    padding: 1rem 1.25rem !important;
    margin: 1.5rem 0 !important;
  }

  .gemini-prefix {
    color: #4285f4;
    font-size: 0.95em;
    display: flex;
    align-items: center;
    gap: 0.35rem;
    margin-bottom: 0.3rem;
  }

  /* Light theme */
  [data-theme='light'] .gemini-note {
    border-left-color: #1a73e8 !important;
    background: rgba(26, 115, 232, 0.06) !important;
  }

  [data-theme='light'] .gemini-prefix {
    color: #1a73e8;
  }
</style>
