---
// ClaudeCodeNote component for Claude Code CLI's commentary / murmur
// Used in SD posts where Claude Code CLI writes its own perspective
// Distinct from ClawdNote: this is the CLI agent speaking, not Clawd (the orchestrator)
// Color: warm brown/sienna (Anthropic brand adjacent)

interface Props {
  /** Optional custom prefix */
  prefix?: string;
}

const { prefix } = Astro.props;

const prefixes = [
  'Claude Code ç¢ç¢å¿µï¼š',
  'Claude Code å…§å¿ƒ OSï¼š',
  'Claude Code è‡ªè¨€è‡ªèªï¼š',
  'Claude Code å·å·è¬›ï¼š',
  'Claude Code æœ‰è©±è¦èªªï¼š',
  'Claude Code murmurï¼š',
  'Claude Code å¿ä¸ä½ï¼š',
  'Claude Code çœŸå¿ƒè©±ï¼š',
];

const slotContent = await Astro.slots.render('default');

function hashString(str: string): number {
  let hash = 0;
  for (let i = 0; i < str.length; i++) {
    const char = str.charCodeAt(i);
    hash = (hash << 5) - hash + char;
    hash = hash & hash;
  }
  return Math.abs(hash);
}

const contentHash = hashString(slotContent);
const selectedPrefix = prefix || prefixes[contentHash % prefixes.length];
---

<blockquote class="claude-code-note">
  <strong class="claude-code-prefix">
    ğŸ§  {selectedPrefix}
  </strong>
  <br />
  <Fragment set:html={slotContent} />
</blockquote>

<style>
  .claude-code-note {
    border-left: 4px solid #b8860b !important;
    background: rgba(184, 134, 11, 0.06) !important;
    font-style: italic;
    border-radius: 0 12px 12px 0 !important;
    padding: 1rem 1.25rem !important;
    margin: 1.5rem 0 !important;
  }

  .claude-code-prefix {
    color: #b8860b;
    font-size: 0.95em;
    display: flex;
    align-items: center;
    gap: 0.35rem;
    margin-bottom: 0.3rem;
  }

  /* Dark theme */
  [data-theme='dark'] .claude-code-note {
    border-left-color: #daa520 !important;
    background: rgba(218, 165, 32, 0.08) !important;
  }

  [data-theme='dark'] .claude-code-prefix {
    color: #daa520;
  }

  /* Light theme */
  [data-theme='light'] .claude-code-note {
    border-left-color: #b8860b !important;
    background: rgba(184, 134, 11, 0.06) !important;
  }

  [data-theme='light'] .claude-code-prefix {
    color: #996515;
  }
</style>
