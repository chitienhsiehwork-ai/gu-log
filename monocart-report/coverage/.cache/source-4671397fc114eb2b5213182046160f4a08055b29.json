{"id":"4671397fc114eb2b5213182046160f4a08055b29","url":"http://localhost:4321/src/components/BackToTop.astro?astro&type=script&index=0&lang.ts","source":"function initBackToTop() {\n  const button = document.getElementById(\"back-to-top\");\n  if (!button) return;\n  let ticking = false;\n  const threshold = 300;\n  function shouldShowButton() {\n    const docHeight = document.documentElement.scrollHeight;\n    const viewportHeight = window.innerHeight;\n    return docHeight > viewportHeight + 400;\n  }\n  function updateButtonVisibility() {\n    if (!button) return;\n    const scrollTop = window.scrollY || document.documentElement.scrollTop;\n    if (shouldShowButton() && scrollTop > threshold) {\n      button.classList.add(\"visible\");\n    } else {\n      button.classList.remove(\"visible\");\n    }\n    ticking = false;\n  }\n  function onScroll() {\n    if (!ticking) {\n      requestAnimationFrame(updateButtonVisibility);\n      ticking = true;\n    }\n  }\n  function scrollToTop(e) {\n    e.preventDefault();\n    window.scrollTo({\n      top: 0,\n      behavior: \"smooth\"\n    });\n  }\n  updateButtonVisibility();\n  window.addEventListener(\"scroll\", onScroll, { passive: true });\n  button.addEventListener(\"click\", scrollToTop);\n  window.addEventListener(\n    \"resize\",\n    () => {\n      updateButtonVisibility();\n    },\n    { passive: true }\n  );\n}\ninitBackToTop();\ndocument.addEventListener(\"astro:page-load\", initBackToTop);\n","sourceMap":{"version":3,"sources":["BackToTop.astro"],"sourcesContent":["---\n/**\n * Back to Top Button Component\n *\n * Floating button that appears after scrolling 300px+ down.\n * Smooth scrolls to top on click.\n * Styled to be subtle and match Solarized theme.\n */\n\ninterface Props {\n  lang?: 'zh-tw' | 'en';\n}\n\nconst { lang = 'zh-tw' } = Astro.props;\n\nconst labels = {\n  'zh-tw': {\n    ariaLabel: '返回頂部',\n    title: '返回頂部',\n  },\n  en: {\n    ariaLabel: 'Back to top',\n    title: 'Back to top',\n  },\n};\n\nconst t = labels[lang];\n---\n\n<button id=\"back-to-top\" class=\"back-to-top\" aria-label={t.ariaLabel} title={t.title} type=\"button\">\n  <svg\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    stroke-width=\"2\"\n    stroke-linecap=\"round\"\n    stroke-linejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polyline points=\"18 15 12 9 6 15\"></polyline>\n  </svg>\n</button>\n\n<script>\n  function initBackToTop() {\n    const button = document.getElementById('back-to-top');\n    if (!button) return;\n\n    let ticking = false;\n    const threshold = 300; // Show button after scrolling 300px\n\n    // Check if page is tall enough to need back-to-top button\n    function shouldShowButton(): boolean {\n      const docHeight = document.documentElement.scrollHeight;\n      const viewportHeight = window.innerHeight;\n      return docHeight > viewportHeight + 400; // Only show if page is significantly tall\n    }\n\n    // Update button visibility based on scroll position\n    function updateButtonVisibility() {\n      if (!button) return;\n\n      const scrollTop = window.scrollY || document.documentElement.scrollTop;\n\n      if (shouldShowButton() && scrollTop > threshold) {\n        button.classList.add('visible');\n      } else {\n        button.classList.remove('visible');\n      }\n\n      ticking = false;\n    }\n\n    // Throttle scroll events with RAF\n    function onScroll() {\n      if (!ticking) {\n        requestAnimationFrame(updateButtonVisibility);\n        ticking = true;\n      }\n    }\n\n    // Smooth scroll to top\n    function scrollToTop(e: Event) {\n      e.preventDefault();\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth',\n      });\n    }\n\n    // Initialize visibility on load\n    updateButtonVisibility();\n\n    // Listen to scroll and click events\n    window.addEventListener('scroll', onScroll, { passive: true });\n    button.addEventListener('click', scrollToTop);\n\n    // Re-check on resize (page height might change)\n    window.addEventListener(\n      'resize',\n      () => {\n        updateButtonVisibility();\n      },\n      { passive: true }\n    );\n  }\n\n  // Initialize on page load\n  initBackToTop();\n\n  // Re-initialize on view transitions (Astro)\n  document.addEventListener('astro:page-load', initBackToTop);\n</script>\n\n<style>\n  .back-to-top {\n    position: fixed !important;\n    bottom: 1.5rem !important;\n    right: 1.5rem !important;\n    width: 48px;\n    height: 48px;\n    border-radius: 50%;\n    background: var(--color-surface);\n    border: 1px solid var(--color-border);\n    color: var(--color-text);\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    visibility: hidden;\n    transform: translateY(10px) translateZ(0); /* translateZ(0) forces GPU layer for Safari */\n    -webkit-transform: translateY(10px) translateZ(0);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    z-index: 9999;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    -webkit-tap-highlight-color: transparent;\n    -webkit-backface-visibility: hidden; /* Safari fixed positioning fix */\n    backface-visibility: hidden;\n  }\n\n  .back-to-top.visible {\n    opacity: 0.7;\n    visibility: visible;\n    transform: translateY(0) translateZ(0);\n    -webkit-transform: translateY(0) translateZ(0);\n  }\n\n  .back-to-top:hover {\n    opacity: 1;\n    transform: translateY(-2px) translateZ(0);\n    -webkit-transform: translateY(-2px) translateZ(0);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);\n    border-color: var(--color-accent);\n  }\n\n  .back-to-top:active {\n    transform: translateY(0) translateZ(0);\n    -webkit-transform: translateY(0) translateZ(0);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n  }\n\n  .back-to-top:focus-visible {\n    outline: 2px solid var(--color-accent);\n    outline-offset: 2px;\n    opacity: 1;\n  }\n\n  .back-to-top svg {\n    flex-shrink: 0;\n  }\n\n  /* Mobile adjustments */\n  @media (max-width: 640px) {\n    .back-to-top {\n      bottom: 1.5rem;\n      right: 1.5rem;\n      width: 44px;\n      height: 44px;\n    }\n  }\n\n  /* Touch-friendly sizing */\n  @media (pointer: coarse) {\n    .back-to-top {\n      width: 52px;\n      height: 52px;\n    }\n  }\n\n  /* Respect reduced motion preference */\n  @media (prefers-reduced-motion: reduce) {\n    .back-to-top {\n      transition:\n        opacity 0.2s,\n        visibility 0.2s;\n    }\n  }\n\n  /* Theme-specific adjustments */\n  [data-theme='light'] .back-to-top {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  }\n\n  [data-theme='light'] .back-to-top:hover {\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);\n  }\n\n  [data-theme='dark'] .back-to-top {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n  }\n\n  [data-theme='dark'] .back-to-top:hover {\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);\n  }\n</style>"],"mappings":"AA8CE,SAAS,gBAAgB;AACvB,QAAM,SAAS,SAAS,eAAe,aAAa;AACpD,MAAI,CAAC,OAAQ;AAEb,MAAI,UAAU;AACd,QAAM,YAAY;AAGlB,WAAS,mBAA4B;AACnC,UAAM,YAAY,SAAS,gBAAgB;AAC3C,UAAM,iBAAiB,OAAO;AAC9B,WAAO,YAAY,iBAAiB;EACtC;AAGA,WAAS,yBAAyB;AAChC,QAAI,CAAC,OAAQ;AAEb,UAAM,YAAY,OAAO,WAAW,SAAS,gBAAgB;AAE7D,QAAI,iBAAiB,KAAK,YAAY,WAAW;AAC/C,aAAO,UAAU,IAAI,SAAS;IAChC,OAAO;AACL,aAAO,UAAU,OAAO,SAAS;IACnC;AAEA,cAAU;EACZ;AAGA,WAAS,WAAW;AAClB,QAAI,CAAC,SAAS;AACZ,4BAAsB,sBAAsB;AAC5C,gBAAU;IACZ;EACF;AAGA,WAAS,YAAY,GAAU;AAC7B,MAAE,eAAe;AACjB,WAAO,SAAS;MACd,KAAK;MACL,UAAU;IACZ,CAAC;EACH;AAGA,yBAAuB;AAGvB,SAAO,iBAAiB,UAAU,UAAU,EAAE,SAAS,KAAK,CAAC;AAC7D,SAAO,iBAAiB,SAAS,WAAW;AAG5C,SAAO;IACL;IACA,MAAM;AACJ,6BAAuB;IACzB;IACA,EAAE,SAAS,KAAK;EAClB;AACF;AAGA,cAAc;AAGd,SAAS,iBAAiB,mBAAmB,aAAa;","names":[]}}