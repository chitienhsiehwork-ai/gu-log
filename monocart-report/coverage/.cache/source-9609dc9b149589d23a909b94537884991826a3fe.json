{"id":"9609dc9b149589d23a909b94537884991826a3fe","url":"http://localhost:4321/posts/shroom-picks-20260211-obsidian-cli-ai-era","source":"\n(function() {\n  'use strict';\n\n  var JWT_KEY = 'gu-log-jwt';\n  var RETURN_KEY = 'gu-log-return-url';\n\n  var el = document.getElementById('login-indicator');\n  if (!el) return;\n\n  var apiUrl = el.getAttribute('data-api-url') || '';\n  var lang = el.getAttribute('data-lang') || 'zh-tw';\n\n  function getJwt() {\n    try { return localStorage.getItem(JWT_KEY); } catch(e) { return null; }\n  }\n\n  function parseJwt(token) {\n    try {\n      var base64 = token.split('.')[1];\n      var json = atob(base64.replace(/-/g, '+').replace(/_/g, '/'));\n      return JSON.parse(json);\n    } catch(e) {\n      return null;\n    }\n  }\n\n  function render() {\n    var jwt = getJwt();\n\n    if (jwt) {\n      var payload = parseJwt(jwt);\n      var email = (payload && (payload.email || payload.login || payload.sub)) || '?';\n\n      el.innerHTML =\n        '<span class=\"login-user\" title=\"' + email + '\">' +\n          'ðŸ‘¤ ' + (email.length > 16 ? email.substring(0, 14) + 'â€¦' : email) +\n        '</span>' +\n        '<button class=\"login-logout-btn\" id=\"logout-btn\" title=\"Logout\">âœ•</button>';\n\n      document.getElementById('logout-btn').addEventListener('click', function() {\n        try { localStorage.removeItem(JWT_KEY); } catch(e) {}\n        render();\n      });\n    } else {\n      var loginText = lang === 'en' ? 'Login' : 'Login';\n      el.innerHTML =\n        '<a class=\"login-link\" href=\"' + apiUrl + '/auth/github\" id=\"login-link\">' +\n          loginText +\n        '</a>';\n\n      document.getElementById('login-link').addEventListener('click', function() {\n        try { localStorage.setItem(RETURN_KEY, window.location.href); } catch(e) {}\n      });\n    }\n\n    el.style.display = '';\n  }\n\n  render();\n})();\n"}